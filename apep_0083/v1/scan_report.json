{
  "paper_id": "apep_0083",
  "scan_date": "2026-02-06T12:43:05.594904+00:00",
  "scan_version": "2.0.0",
  "model": "openai/gpt-5.2",
  "overall_verdict": "SUSPICIOUS",
  "files_scanned": 25,
  "flags": [
    {
      "category": "METHODOLOGY_MISMATCH",
      "severity": "HIGH",
      "file": "01_fetch_fars.R",
      "lines": [
        236,
        252
      ],
      "evidence": "The manuscript explicitly states the analysis is restricted to drivers only for drug variables (\"We restrict our analysis to drivers only\"). However, the THC/drug summary is built from the DRUGS file aggregated to the crash level without restricting records to drivers. Unless the DRUGS file is already driver-only (it is person-level and typically includes non-drivers), this will classify a crash as THC-positive if any person (passenger/pedestrian/etc.) has a THC finding. Alcohol is restricted to drivers (per_typ == 1) but drug/THC is not, creating an internal inconsistency and a mismatch with the paper\u2019s stated variable definition.: drug_summary <- fars_drugs_west %>%\n    group_by(st_case, state, year) %>%\n    summarise(\n      any_drug_test = TRUE,\n      thc_positive = any(is_thc_finding, na.rm = TRUE),\n      any_drug_positive = any(drugres == 1, na.rm = TRUE),\n      n_drugs_positive = sum(drugres == 1, na.rm = TRUE),\n      .groups = \"drop\"\n    )",
      "confidence": 0.85
    },
    {
      "category": "SUSPICIOUS_TRANSFORMS",
      "severity": "MEDIUM",
      "file": "01_fetch_fars.R",
      "lines": [
        229,
        234
      ],
      "evidence": "The THC identification regex is broader than the manuscript\u2019s described intent of \"THC-positive finding\" via text matching. In particular, matching on \"Cannabin\" will also match generic strings like \"cannabinoid\" and potentially other cannabinoid-related entries that are not specifically THC, depending on FARS coding/text. Including \"Carboxy\" may also sweep in metabolite text that could be ambiguous across reporting conventions. This could inflate/alter the THC-positive classification relative to a stricter THC-only definition. (This may be defensible, but should be explicitly justified and aligned with the paper\u2019s definition.): thc_patterns <- \"THC|Tetrahydro|Carboxy|Cannabin|Marijuana|Cannabis|Delta\"\n\nfars_drugs_west <- fars_drugs_west %>%\n  mutate(\n    is_thc_finding = grepl(thc_patterns, drugresname, ignore.case = TRUE)\n  )",
      "confidence": 0.7
    },
    {
      "category": "METHODOLOGY_MISMATCH",
      "severity": "HIGH",
      "file": "09_border_figures.R",
      "lines": [
        93,
        169
      ],
      "evidence": "The manuscript states THC identification via text-based drug names is only reliable from 2018 onward and even notes an event-study figure is omitted due to this limitation (Appendix: \"% Event study figure omitted due to data limitations (THC data only available 2018+)\"). Despite that, this script constructs and saves an event-study figure of THC-positive rates around legalization using thc_positive. Given thc_positive is largely unavailable pre-2018 (and the script itself elsewhere filters to 2018+ for THC reliability), this event study will be based on a highly selected post-2018 subset and cannot display credible pre-trends around the 2012\u20132017 legalizations. This is a substantive mismatch between what the figure implies (pre/post dynamics) and what the available data support, and it conflicts with the manuscript\u2019s stated limitation/omission.: # Figure 26: Event Study - THC Rates Around Legalization\n...\nevent_data <- fars %>%\n  filter(ever_rec_legal, !is.na(rel_time_rec), !is.na(thc_positive)) %>%\n  mutate(\n    event_year = floor(rel_time_rec / 12)  # Convert months to years\n  ) %>%\n  filter(event_year >= -5, event_year <= 8)  # 5 years before to 8 years after",
      "confidence": 0.9
    },
    {
      "category": "SELECTIVE_REPORTING",
      "severity": "MEDIUM",
      "file": "09_border_figures.R",
      "lines": [
        90,
        257
      ],
      "evidence": "The code generates THC event-study figures (fig26/fig27), but the manuscript indicates the event-study figure is omitted due to THC data limitations and the main text describes THC as cross-sectional (2018\u20132019) rather than dynamic. This inconsistency raises a selective-reporting/documentation concern: either (a) these figures are being generated but intentionally not discussed, or (b) the manuscript is out of sync with the actual outputs produced by the pipeline. In either case, the replication package should reconcile which outputs are intended for the paper and ensure the paper does not contradict the code-generated results/figures.: # Figure 26: Event Study - THC Rates Around Legalization\n...\n# Figure 27: State-Specific Event Studies\n...\nggsave(file.path(dir_figs, \"fig26_event_study_thc.pdf\"), fig26,\n       width = 10, height = 6, dpi = 300)\n...\nggsave(file.path(dir_figs, \"fig27_event_study_by_state.pdf\"), fig27,\n       width = 10, height = 6, dpi = 300)",
      "confidence": 0.75
    },
    {
      "category": "DATA_PROVENANCE_MISSING",
      "severity": "MEDIUM",
      "file": "10_tables.R",
      "lines": [
        8,
        30
      ],
      "evidence": "The pipeline relies on a pre-existing policy file (marijuana_policy.rds) but no script for constructing/downloading it is included among the provided Paper 109 code files (the manuscript says it comes from the Harvard Dataverse + manual verification). Without a fetch/build script (or a pinned source URL + checksum) for marijuana_policy.rds, the provenance of a key input used to build Table 1 and policy variables cannot be independently verified from the provided code subset.: fars <- readRDS(file.path(dir_data, \"fars_analysis_policy.rds\"))\nmarijuana_policy <- readRDS(file.path(dir_data_policy, \"marijuana_policy.rds\"))",
      "confidence": 0.8
    }
  ],
  "file_verdicts": [
    {
      "file": "09_border_figures.R",
      "verdict": "SUSPICIOUS"
    },
    {
      "file": "01_fetch_fars.R",
      "verdict": "SUSPICIOUS"
    },
    {
      "file": "10_tables.R",
      "verdict": "CLEAN"
    },
    {
      "file": "07_zoom_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "clean_and_fix_data.R",
      "verdict": "CLEAN"
    },
    {
      "file": "00_packages.R",
      "verdict": "CLEAN"
    },
    {
      "file": "debug_thc.R",
      "verdict": "CLEAN"
    },
    {
      "file": "diagnose_thc_rates.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_remaining_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "05_build_analysis.R",
      "verdict": "CLEAN"
    },
    {
      "file": "regenerate_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "regenerate_all_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_testing_rate.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_substance_data.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_polysubstance_figure.R",
      "verdict": "CLEAN"
    },
    {
      "file": "06_national_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_final_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "08_substance_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "04_merge_policy.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_substance_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_all_figure_labels.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_figure_labels.R",
      "verdict": "CLEAN"
    },
    {
      "file": "fix_all_figures.R",
      "verdict": "CLEAN"
    },
    {
      "file": "03_snap_crashes.py",
      "verdict": "CLEAN"
    },
    {
      "file": "02_fetch_osm.py",
      "verdict": "CLEAN"
    }
  ],
  "summary": {
    "verdict": "SUSPICIOUS",
    "counts": {
      "CRITICAL": 0,
      "HIGH": 2,
      "MEDIUM": 3,
      "LOW": 0
    },
    "one_liner": "method mismatch",
    "executive_summary": "The code contradicts the manuscript\u2019s stated sample restrictions for drug measures: despite claiming the analysis is restricted to drivers only, the THC/drug summary is constructed from the FARS **DRUGS** file (which is not limited to drivers), risking inclusion of non-driver records and misaligned estimates. It also conflicts with the paper\u2019s own reliability caveat for text-based THC identification\u2014while the manuscript says this approach is only reliable from 2018 onward and even notes an event-study figure is omitted for that reason, the figure-generating code in `09_border_figures.R` proceeds in a way that can incorporate pre-2018 THC text identifications, undermining the stated methodology.",
    "top_issues": [
      {
        "category": "METHODOLOGY_MISMATCH",
        "severity": "HIGH",
        "short": "The manuscript explicitly states the analysis is restrict...",
        "file": "01_fetch_fars.R",
        "lines": [
          236,
          252
        ],
        "github_url": "/apep_0083/code/01_fetch_fars.R#L236-L252"
      },
      {
        "category": "METHODOLOGY_MISMATCH",
        "severity": "HIGH",
        "short": "The manuscript states THC identification via text-based d...",
        "file": "09_border_figures.R",
        "lines": [
          93,
          169
        ],
        "github_url": "/apep_0083/code/09_border_figures.R#L93-L169"
      }
    ],
    "full_report_url": "/tournament/corpus_scanner/scans/apep_0083_scan.json"
  },
  "error": null
}